{"version":3,"file":"index.module.js","sources":["../src/scrollama-context.js","../src/scrollama.jsx","../src/step.jsx"],"sourcesContent":["import { createContext, useContext } from \"react\";\n\nconst ScrollamaContext = createContext();\n\nconst useScrollamaContext = () => useContext(ScrollamaContext);\n\nexport { ScrollamaContext, useScrollamaContext };","import React from \"react\"\nimport { ScrollamaContext } from \"./scrollama-context\"\nimport scrollama from \"scrollama\"\n\nclass Scrollama extends React.Component {\n  static contextType = ScrollamaContext\n\n  constructor(props) {\n    super(props)\n    this.scroller = scrollama()\n    this.steps = []\n  }\n\n  reset() {\n    window.removeEventListener(\"resize\", this.scroller.resize)\n    this.scroller.destroy()\n    this.initialize()\n    window.addEventListener(\"resize\", this.scroller.resize)\n  }\n\n  setupRef(ref) {\n    this.steps.push(ref.current)\n    this.reset()\n    return () => {\n      this.steps.splice(this.steps.indexOf(ref.current), 1)\n      this.reset()\n    }\n  }\n\n  initialize() {\n    const {\n      offset = 0.5,\n      progress = false,\n      debug = false,\n      onStepEnter = () => {},\n      onStepExit = () => {},\n      onStepProgress = () => {},\n      threshold = 4,\n      once = false,\n      parent = undefined\n    } = this.props\n\n    this.scroller\n      .setup({\n        step: this.steps,\n        offset,\n        progress: progress ? true : false,\n        debug: debug ? true : false,\n        threshold, // the percentage of the viewport that must be visible\n        once,\n        parent,\n      })\n      .onStepEnter((response) => {\n        onStepEnter(response)\n      })\n      .onStepExit((response) => {\n        onStepExit(response)\n      })\n      .onStepProgress((response) => {\n        onStepProgress(response)\n      })\n  }\n\n  componentDidMount() {\n    this.initialize()\n    window.addEventListener(\"resize\", this.scroller.resize)\n  }\n\n  componentWillUnmount() {\n    this.scroller.destroy()\n    window.removeEventListener(\"resize\", this.scroller.resize)\n  }\n\n  render() {\n    const { children, \n      offset, \n      progress, \n      threshold, \n      onStepProgress, \n      onStepEnter, \n      onStepExit, \n      debug, \n      ...primitiveProps \n    } = this.props\n\n    return (\n      <div {...primitiveProps}>\n        <ScrollamaContext.Provider value={(ref) => this.setupRef(ref)}>\n          {children}\n        </ScrollamaContext.Provider>\n      </div>\n    )\n  }\n}\n\nexport default Scrollama\n","import React from \"react\"\nimport { ScrollamaContext } from \"./scrollama-context\"\n\nclass Step extends React.Component {\n  static contextType = ScrollamaContext\n\n  constructor(props) {\n    super(props)\n    this.stepRef = React.createRef()\n    this.remove = null\n  }\n\n  componentDidMount() {\n    this.remove = this.context(this.stepRef)\n  }\n\n  componentWillUnmount() {\n    this.remove()\n  }\n\n  render() {\n    const { children, ...primitiveProps } = this.props\n    return (\n      <div ref={this.stepRef} {...primitiveProps}>\n        {children}\n      </div>\n    )\n  }\n}\n\nexport default Step\n"],"names":["ScrollamaContext","createContext","useScrollamaContext","useContext","Scrollama","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","scroller","scrollama","steps","_createClass","key","value","reset","window","removeEventListener","resize","destroy","initialize","addEventListener","setupRef","ref","_this2","push","current","splice","indexOf","_this$props","_this$props$offset","offset","_this$props$progress","progress","_this$props$debug","debug","_this$props$onStepEnt","onStepEnter","_this$props$onStepExi","onStepExit","_this$props$onStepPro","onStepProgress","_this$props$threshold","threshold","_this$props$once","once","_this$props$parent","parent","undefined","setup","step","response","componentDidMount","componentWillUnmount","render","_this3","_this$props2","children","primitiveProps","_objectWithoutProperties","_excluded","React","createElement","Provider","Component","_defineProperty","Step","stepRef","createRef","remove","context","_extends"],"mappings":"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"}