{"version":3,"file":"index.js","sources":["../src/scrollama-context.js","../src/scrollama.jsx","../src/step.jsx"],"sourcesContent":["import { createContext, useContext } from \"react\";\n\nconst ScrollamaContext = createContext(null);\n\nconst useScrollamaContext = () => {\n  const context = useContext(ScrollamaContext);\n  if (context === undefined) {\n    throw new Error(\"useScrollamaContext must be used within a ScrollamaProvider\");\n  }\n  return context;\n};\n\nexport { ScrollamaContext, useScrollamaContext };","import React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { ScrollamaContext } from \"./scrollama-context\";\nimport scrollama from \"scrollama\";\n\nconst Scrollama = ({\n  children,\n  offset = 0.5,\n  progress = false,\n  debug = false,\n  onStepEnter = () => {},\n  onStepExit = () => {},\n  onStepProgress = () => {},\n  threshold = 4,\n  once = false,\n  parent = undefined,\n  ...primitiveProps\n}) => {\n  const [scroller] = useState(() => scrollama());\n  const stepsRef = useRef([]);\n\n  const reset = useCallback(() => {\n    window.removeEventListener(\"resize\", scroller.resize);\n    scroller.destroy();\n    initialize();\n    window.addEventListener(\"resize\", scroller.resize);\n  }, [scroller]);\n\n  const setupRef = useCallback((ref) => {\n    if (ref && ref.current) {\n      stepsRef.current.push(ref.current);\n      reset();\n      return () => {\n        stepsRef.current = stepsRef.current.filter((step) => step !== ref.current);\n        reset();\n      };\n    }\n  }, [reset]);\n\n  const initialize = useCallback(() => {\n    if (stepsRef.current.length <= 0) {\n      return;\n    }\n\n    scroller\n      .setup({\n        step: stepsRef.current,\n        offset,\n        progress: progress ? true : false,\n        debug: debug ? true : false,\n        threshold,\n        once,\n        parent,\n      })\n      .onStepEnter(onStepEnter)\n      .onStepExit(onStepExit)\n      .onStepProgress(onStepProgress);\n  }, [scroller, offset, progress, debug, threshold, once, parent, onStepEnter, onStepExit, onStepProgress]);\n\n  useEffect(() => {\n    initialize();\n    window.addEventListener(\"resize\", scroller.resize);\n\n    return () => {\n      scroller.destroy();\n      window.removeEventListener(\"resize\", scroller.resize);\n    };\n  }, []);\n\n  return (\n    <div {...primitiveProps}>\n      <ScrollamaContext.Provider value={setupRef}>\n        {children}\n      </ScrollamaContext.Provider>\n    </div>\n  );\n};\n\nexport default Scrollama;","import React, { useRef, useEffect, useContext } from \"react\";\nimport { ScrollamaContext } from \"./scrollama-context\";\n\nconst Step = ({ children, ...primitiveProps }) => {\n  const stepRef = useRef(null);\n  const context = useContext(ScrollamaContext);\n\n  useEffect(() => {\n    const remove = context(stepRef);\n    return () => {\n      remove();\n    };\n  }, [context]);\n\n  return (\n    <div ref={stepRef} {...primitiveProps}>\n      {children}\n    </div>\n  );\n};\n\nexport default Step;"],"names":["ScrollamaContext","createContext","useScrollamaContext","context","useContext","undefined","Error","Scrollama","_ref","children","_ref$offset","offset","_ref$progress","progress","_ref$debug","debug","_ref$onStepEnter","onStepEnter","_ref$onStepExit","onStepExit","_ref$onStepProgress","onStepProgress","_ref$threshold","threshold","_ref$once","once","_ref$parent","parent","primitiveProps","_objectWithoutProperties","_excluded","_useState","useState","scrollama","_useState2","_slicedToArray","scroller","stepsRef","useRef","reset","useCallback","window","removeEventListener","resize","destroy","initialize","addEventListener","setupRef","ref","current","push","filter","step","length","setup","useEffect","React","createElement","Provider","value","Step","stepRef","remove","_extends"],"mappings":"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"}