{"version":3,"file":"index.esm.js","sources":["../src/scrollama-context.js","../src/scrollama.jsx","../src/step.jsx"],"sourcesContent":["import { createContext, useContext } from \"react\";\n\nconst ScrollamaContext = createContext();\n\nconst useScrollamaContext = () => useContext(ScrollamaContext);\n\nexport { ScrollamaContext, useScrollamaContext };","import React from \"react\"\nimport { ScrollamaContext } from \"./scrollama-context\"\nimport scrollama from \"scrollama\"\n\nclass Scrollama extends React.Component {\n  static contextType = ScrollamaContext\n\n  constructor(props) {\n    super(props)\n    this.scroller = scrollama()\n    this.steps = []\n  }\n\n  reset() {\n    window.removeEventListener(\"resize\", this.scroller.resize)\n    this.scroller.destroy()\n    this.initialize()\n    window.addEventListener(\"resize\", this.scroller.resize)\n  }\n\n  setupRef(ref) {\n    this.steps.push(ref.current)\n    this.reset()\n    return () => {\n      this.steps.splice(this.steps.indexOf(ref.current), 1)\n      this.reset()\n    }\n  }\n\n  initialize() {\n    const {\n      offset = 0.5,\n      progress = false,\n      debug = false,\n      onStepEnter = () => {},\n      onStepExit = () => {},\n      onStepProgress = () => {},\n      threshold = 4,\n      once = false,\n      parent = undefined\n    } = this.props\n\n    this.scroller\n      .setup({\n        step: this.steps,\n        offset,\n        progress: progress ? true : false,\n        debug: debug ? true : false,\n        threshold, // the percentage of the viewport that must be visible\n        once,\n        parent,\n      })\n      .onStepEnter((response) => {\n        onStepEnter(response)\n      })\n      .onStepExit((response) => {\n        onStepExit(response)\n      })\n      .onStepProgress((response) => {\n        onStepProgress(response)\n      })\n  }\n\n  componentDidMount() {\n    this.initialize()\n    window.addEventListener(\"resize\", this.scroller.resize)\n  }\n\n  componentWillUnmount() {\n    this.scroller.destroy()\n    window.removeEventListener(\"resize\", this.scroller.resize)\n  }\n\n  render() {\n    const { children, \n      offset, \n      progress, \n      threshold, \n      onStepProgress, \n      onStepEnter, \n      onStepExit, \n      debug, \n      ...primitiveProps \n    } = this.props\n\n    return (\n      <div {...primitiveProps}>\n        <ScrollamaContext.Provider value={(ref) => this.setupRef(ref)}>\n          {children}\n        </ScrollamaContext.Provider>\n      </div>\n    )\n  }\n}\n\nexport default Scrollama\n","import React from \"react\"\nimport { ScrollamaContext } from \"./scrollama-context\"\n\nclass Step extends React.Component {\n  static contextType = ScrollamaContext\n\n  constructor(props) {\n    super(props)\n    this.stepRef = React.createRef()\n    this.remove = null\n  }\n\n  componentDidMount() {\n    this.remove = this.context(this.stepRef)\n  }\n\n  componentWillUnmount() {\n    this.remove()\n  }\n\n  render() {\n    const { children, ...primitiveProps } = this.props\n    return (\n      <div ref={this.stepRef} {...primitiveProps}>\n        {children}\n      </div>\n    )\n  }\n}\n\nexport default Step\n"],"names":["ScrollamaContext","createContext","useScrollamaContext","useContext","Scrollama","_React$Component","props","_this","_classCallCheck","_callSuper","scroller","scrollama","steps","_inherits","_createClass","key","value","reset","window","removeEventListener","resize","destroy","initialize","addEventListener","setupRef","ref","_this2","push","current","splice","indexOf","_this$props","_this$props$offset","offset","_this$props$progress","progress","_this$props$debug","debug","_this$props$onStepEnt","onStepEnter","_this$props$onStepExi","onStepExit","_this$props$onStepPro","onStepProgress","_this$props$threshold","threshold","_this$props$once","once","_this$props$parent","parent","undefined","setup","step","response","componentDidMount","componentWillUnmount","render","_this3","_this$props2","children","primitiveProps","_objectWithoutProperties","_excluded","React","createElement","Provider","Component","_defineProperty","Step","stepRef","createRef","remove","context","_extends"],"mappings":"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"}